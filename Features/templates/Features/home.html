{% extends 'Features/base.html' %}

{% load static %}

{% block content %}
<title>Home</title>

<div id="videoPlayer">
    <!-- Most Recent Video from NCF YouTube will be inserted here -->
</div>
<div id="recentDoodles">
    <h2>Most Recent Novo Art</h2>
    <!-- Top 5 Most Recent Doodles -->
    {% for doodle in recent_doodles %}
    <div class="doodle">
        <img src="{{ doodle.image.url }}" alt="Doodle by {{ doodle.user.username }}">
        <p>Created by {{ doodle.user.username }}</p>
    </div>
    {% endfor %}
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        var apiKey = '{{ youtube_api_key }}';
        var channelId = '{{ channel_id }}';
        var url = `https://www.googleapis.com/youtube/v3/search?key=${apiKey}&channelId=${channelId}&part=snippet,id&order=date&maxResults=1`;

        fetch(url)
            .then(response => response.json())
            .then(data => {
                var videoId = data.items[0].id.videoId;
                var videoFrame = `<iframe width="560" height="315" src="https://www.youtube.com/embed/${videoId}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>`;
                document.getElementById('videoPlayer').innerHTML = videoFrame;
            })
            .catch(error => console.log('Error fetching video:', error));
    });
</script>

{% endblock %}
